\section[Witnessing metrologically useful entanglement]
{Witnessing metrologically useful {\color{grey} X} entanglement}
\input{snp/doubleLineWaterMark.tex}

\quotes{Adrien-Marie Legendre}{All the truths of mathematics are linked to each other,

and all means of discovering them are equally admissible.}

\lettrine[lines=2, findent=3pt,nindent=0pt]{T}{ypically}, one has not access to the density matrix of the system been used for metrology or for other quantum process.
Moreover, for systems on which the particle number is very large, this is the case when one wants to do metrology with quantum states, the details of the density matrix are forbidden by practical reasons.
Since the quantum Fisher information is based on the complete knowledge of the density matrix, shortcuts to avoid the complete tomography must be developed as we have had shown one practical case on the previous chapter.
In this chapter, we obtain a general procedure to get an optimal bound for the quantum Fisher information based on as many expectation values of the initial state as one is ready to measure.
Two main features are worth to mention again.
First, in general this method gives us an optimal tight bound.
Last but not least, the bound is based on the expectation values of the initial state only, so it is not necessary to perform an evolution of the state to estimate how well will it behave.
This is in contrast to other approaches one can find in the literature, an it is a time saving concept.

The figure of merit of bounds from below for the quantum Fisher information based on expectation values of the initial state is the following,
\be
  \qfi [\rho,J_z] \geq \frac{\expect{J_x}^2}{\varian{J_y}}.
\ee
where the state is polarized along the $x$-axis and the variance of the $J_y$ operator is smaller than the standard.
On the previous chapter we also have shown one of these bound specifically designed for unpolarized Dicke states.

Homogeneous magnetometry, $\bs{B} = B\bs{k}$ where $B$ is constant in time.

Section~[REF], see magnetometry, generator $J_z$.

Quantum Fisher information $\qfi [\rho, J_z]$.

\subsection{Bound from below of a function convex over the states given some arbitrary expectation values}

The problem of getting a lower bound for a convex function on the states having already some expectation values of some arbitrary observables was studied by O. G\"uhne {\it et al.} and J. Eisert {\it et al.} in Refs.~\citep{Guehne2007, Eisert2007} respectively, mainly from the perspective of entanglement measures.
The illustrated techniques are based on the well known Legendre transform for differentiable functions, see Appedix~\ref{app:legendre-transform} for more details.
We first review in this section the state-of-the-art solution for this problem.
And later on, we extend it to the quantum Fisher information.
For simplicity in the next subsection, Sec~\ref{}, we assume that a single expectation value is given.
An extension to the case on which more expectation values are given will follow in the Subsection~\ref{}.
Finally, we will summarize it with an explicit formula which will be used to compute the bounds.

\subsubsection{Estimation of a general convex function based on the expectation value of an arbitrary observable}

When a convex function $g(\rho)$ is given together with an expectation value of some operator $w=\tr(\rho W)$, a tight lower bound, $\mathcal{B}_g(w)$, can be obtained as \citep{Rockafellar1996, Guehne2007, Eisert2007}
\be
  \label{eq:lt-lower-bound-single-parameter}
  \begin{split}
    g(\rho)\geq\mathcal{B}_g(w):=\,&\sup_r \{ rw - \hat{g}(rW)\}\\
    =\,& \{\inf_{\rho}g(\rho)\,|\,w = \tr(\rho W)\}
  \end{split}
\ee
where $\hat{g}(rW)$ is the Legendre transform of $g(\rho)$ and the second equality expresses the tightness of the bound.
The Legendre transform in this context is defined as
\be
  \label{eq:lt-for-convex-function-single-parameter}
  \hat{g}(rW)=\sup_{\rho}\{\expect{rW}_\rho - g(\rho)\},
\ee
where the maximisation is over \emph{all} possible states.
This method to obtain the lower bound has been used to compute entanglement measures, as we mentioned before [].

Following the theory one can find that in the case on which the convex function $g(\rho)$ is defined as convex roof over all possible convex decompositions of the state, the optimisation of Eq.~(\ref{eq:lt-for-convex-function-single-parameter}) can be reduced to an optimisation over pure states only, thus simplifying the process \cite{}
\be
\begin{split}
  \hat{g}(rW) & = \sup_{\rho}\{r\expect{W}_\rho - g(\rho)\} \\
  &=\sup_{\rho}\Big\{r\expect{W}_\rho - \inf_{\{p_k,\ket{\phi_k}\}}\big\{\sum_{k} p_k g(\ket{\phi_k})\big\} \Big\} \\
  &=\sup_{\{p_k, \ket{\phi_k}\}} \Big\{ \sum_k p_k r\expect{W}_{\ket{\phi_k}} - \inf_{\{p_k, \ket{\phi_k}\}} \big\{\sum_k p_k g(\ket{\phi_k}) \big\}  \Big\} \\
  &=\sup_{\{p_k, \ket{\phi_k}\}} \Big\{ \sum_k p_k \big\{ r\expect{W}_{\ket{\phi_k}} - g(\ket{\phi_k}) \big\} \Big\} \\
  &=\sup_{\ket{\psi}} \big\{ r\expect{W}_{\ket{\psi}} - g(\ket{\psi}) \big\}.
\end{split}
\ee
However, even an optimization over all pure states is feasible numerically only for small systems.
We will show later on this section how to circumvent this issue in the case of the QFI.
The convex roof construction has the following form
\be
  g(\rho) = \inf_{\{p_k,\psi_k\}} \sum_{k}p_k g(\ket{\psi_k}),
\ee
where the mixed state is decomposed into $\rho = \sum_k p_k \ketbra{\psi_k}{\psi_k}$.
Among other definitions of the QFI on the literature, there is one that defines it as the convex roof of $4\varian{J_z}$, the variance of the generator, as it has been shown on Ref.~\citep{Toth2007, }, we can compute the Legendre transform optimizing for pure states only.
Hence, we will be able to use this simplification to apply this method to obtain the lower bound on the QFI.
Notice that in this context the QFI is the convex roof of four times the variance of the generator, Eq.~\eqref{}.

\subsubsection{Measuring several observables}

For some cases, it is interesting to characterise the quantum state not only with a single measurement but with several.
For instance, we could want to use, as it is done with the spin-squeezed states the absolute polarisation and the variance of one of the orthogonal components of the angular momentum to detect entanglement and metrological usefulness \citep{}.
So far, we studied the case on which a single measurement is used.
Its extension to several expectation values is indeed straight-forward.
We can generalize Eqs.~\eqref{eq:lt-lower-bound-single-parameter} and \eqref{eq:lt-for-convex-function-single-parameter} for several observables $\{W_i\}_{i=1}^M$ as follows \citep{Guehne2007}
\be
  \label{eq:lt-extension-bound-multiparameter}.
  \mathcal{B}_g(w_1,w_2,\dots) := \sup_{\bs{r}}\big\{\bs{rw}-\sup_{\rho}\{\expect{\bs{rW}}-g(\rho)\}\big\},
\ee
where $\bs{ab} =\sum_{k=1}^M a_kb_k$, the usual notation for scalar products of two vectors.

\subsubsection{Explicit form of the expression to be optimized}

After we have shown how to find a lower bound for a general convex function of the state based on its expectation values and how to simplify that method for the case on which the function is defined as convex roof, now we are in a position to achieve the main goal of this chapter.
First of all, we notice that for the quantum Fisher Information the inner maximization, the Legendre transform, is obtained optimizing a quadratic function on expectation values,
\be
\label{eq:lt-legendre-of-qfi}
\begin{split}
  \hat{\qfi}(rW) &= \sup_{\ket{\psi}}\big\{r\expect{W}_{\psi}-4\varian{J_z}_{\psi}\big\} \\
  &= \sup_{\ket{\psi}} \big\{ r\expect{W}_{\psi}-4\expect{J_z^2}_{\psi} + 4\expect{J_z}^2_{\psi} \big\} \\
  &= \sup_{\ket{\psi}} \big\{\expect{rW-4J_z^2}_{\psi} +
  \expect{2J_z}^2_{\psi}\big\},
\end{split}
\ee
where we have used the fact that the QFI can be expressed as convex roof of $\varian{J_z}$ and we again fall into the problem of a single parameter for simplicity on the following derivations.
Equation~\eqref{eq:lt-legendre-of-qfi} can be rewritten as an optimization linear in operator expectation values as
\be
  \hat{\mathcal{F}}_{\text{Q}}(rW) = \sup_{\ket{\psi},\mu}\big\{\expect{rW-4J_z^2}_{\psi}+8\mu\expect{J_z}_\psi - 4 \mu^2\big\},
\ee
which, making use of $\max\{\expect{A}\}=\lambda_{\max}[A]$ for any observable, can be reformulated as
\be
  \label{eq:lt-legendre-for-qfi-simplified}
  \begin{split}
    \hat{\mathcal{F}}_{\text{Q}}(rW) & = \sup_{\ket{\psi}}\big\{\lambda_{\max}[rW-4J_z^2+8\mu J_z - 4 \mu^2]\big\}\\
    &=\sup_{\ket{\psi}}\big\{\lambda_{\max}[rW-4(J_z-\mu)^2]\big\}
  \end{split}
\ee
where $\lambda_{\max}[A]$ stands for the maximum eigenvalue of the operator $A$.
At the extremum, we make the following observation, the derivative with respect to $\mu$ must be zero, hence at the optimum $\mu=\expect{J_z}_{\text{opt}}$ which represents the expectation value $J_z$ should have considering the optimal state on Eq.~\eqref{eq:lt-legendre-of-qfi}.
This also means that we have to test $\mu$ values in the interval $-N/2\leq\mu\leq N/2$ only for spin-half systems.

The full optimization problem to be solved consists of Eqs.~\eqref{eq:lt-lower-bound-single-parameter} and~\eqref{eq:lt-legendre-for-qfi-simplified} substituting $g(\rho)$ by $\qfi[\rho,J_z]$,
\be
  \mathcal{B}_{\mathcal{F}} = \sup_r\big\{rw-\sup_{\mu}\{\lambda_{\max}[rW-4(J_z-\mu)^2]\}\big\}.
\ee
It is crucial that the optimization over $r$ is a concave function, since the theory tells us that $\hat{\mathcal{F}}_{\text{Q}}(rW)$ is a convex function \citep{}, even when the multi-parametric case is considered.
Thus the optimum can be determined easily with simple methods, e.g., the gradient method, looking for the maximum in $r$.
Based on Eq.~\eqref{eq:lt-lower-bound-single-parameter}, we can see that even if we do not find the global optimum in $r$, we obtain a valid lower bound.
The extension of this bound to the multi-parametric case is done using the recipie given in Eq.~\eqref{eq:lt-extension-bound-multiparameter}.

We stress again the generality of this findings beyond linear interferometers covered on the following sections.
For nonlinear interferometers \citep{,,,,,}, the phase $\theta$ must be estimate in an unitary dynamics $U=\exp{-iG\theta}$, where $G$ is not a sum of single spin operators, hence, is different from the angular momentum components.

Next, we will demonstrate the use of our approach for several experimentally relevant situations.
In the many-particle case, often symmetric operators can be used to describe accurately the system, which makes possible to carry out calculations for thousand of particles, as will be presented later on this chapter.

\begin{figure}
  \centering
  \igwithlabel{(a)}{scale=.65}{img/plots/LT_fidGHZ.pdf}
  \igwithlabel{(b)}{scale=.65}{img/plots/LT_fidDicke.pdf}
  \caption{(a) Analytical solution of the bound $\mathcal{B}_{\mathcal{F}}$ for different values of the fidelity with respect to the GHZ state. (b) Numerical results for the minimum quantum Fisher information as a function of the fidelity with respect of unpolarise Dicke states perpendicular to the magnetic field, $|\text{D}_N^0\rangle$. (blue-line) For systems with 4 particles and (red-dashed) for system with 8 particles. One may notice that when the fidelity is at its maximum the bound approaches to 0.5 as it is the quantum Fisher information for large particle number.}
  \label{fig:vd-secuence-evo}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[scale=.65]{img/plots/LT_spsq2d_4.pdf}
  \caption{We show as a function of the expectation value, $\expect{J_y}$, and the variance in the perpendicular direction, $\varian{J_x}$, the minimum sensitivity for a 4-qubit system.
  (hatched) The physically forbidden region is indicated. (M,T,S,D) Those points indicate where the mixed state (), the totally polarized state (), the single state and the unpolarized Dicke state would be located. (W) on this line sit any of the states which is a mixture between the completely mixed state of the symmetric subspace and the singlet state among others, for instance the completely mixed state of the whole Hilbert space. (dashed) It indicates the shot-noise threshold where below it non-classical sensitivities can be achieved.}
  \label{fig:lt-spsq2d-4}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[scale=.65]{img/plots/LT_edge_diff.pdf}
  \caption{Difference between the bound of Pezze-Smerzi and the optimal bound for the quantum Fisher information normalized by the value of the optimal bound itself for the bosonic ground states of $H=J_x^2-\lambda J_y$ for $\forall \lambda \in [0,\infty)$.
  From dark to lighter colors (line, point, dash-point, dashed, pointed, line), results for different particle numbers, $N=4,6,10,20,1000$ respectively.
  Heuristically speaking, one can say that for large particle number the difference is biggest when the polarisation is around two thirds of the maximal polarisation and that this difference is about $2.6\%$.}
  \label{fig:lt-edge-diff}
\end{figure}

\begin{figure}
  \centering
  \igwithlabel{(a)}{scale=.65}{img/plots/LT_spsq_scaling_1.pdf}
  \igwithlabel{(b)}{scale=.65}{img/plots/LT_spsq_scaling_2.pdf}
  \caption{}
  \label{fig:lt-spsq-scaling}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[scale=.65]{img/plots/LT_dicke_edge.pdf}
  \caption{The numerics shows us a tiny region the symmetric system surpassing the shot-noise threshold.}
  \label{fig:vd-secuence-evo}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[scale=.65]{img/plots/LT_dicke_7900_asymp.pdf}
  \caption{Secuence of the evolution of an unpolarized Dicke state of 16 qubits for $\Theta=\{i\pi/6\}_{i=0}^4$. Bloch spheres representing the Hirusi distribution of the state, and below PDF of the $J_x$ POVM for each step of the secuence}
  \label{fig:vd-secuence-evo}
\end{figure}
